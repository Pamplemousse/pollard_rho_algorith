EXE=pollard

CFLAGS=-std=c11 -Wall -Wextra -Wno-unused-result -g -pg -no-pie
CPPFLAGS=-Iinclude -DDEBUG
LDFLAGS=-lgmp

.PHONY: all clean test help


all: clean build

build:
	$(MAKE) $(EXE)

$(EXE): main.o equation_solver.o collision.o iteration.o
	$(CC) $(CFLAGS) -o $@ $^ $(LDFLAGS)

%.o: %.c %.h
	$(CC) $(CFLAGS) $(CPPFLAGS) -c $<

clean:
	@rm -f *.o $(EXE)
	@rm -f gmon.out
	@rm -f temp-plot.html
	@cd test && $(MAKE) clean

test:
	$(MAKE)
	@cd test && $(MAKE)

help:
	@echo "Usage:"
	@echo -e "  make [all]\t\tClean then build"
	@echo -e "  make build\t\tBuild the executable"
	@echo -e "  make clean\t\tRemove all files generated by make"
	@echo -e "  make help\t\tDisplay this help"
